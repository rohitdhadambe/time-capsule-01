# ðŸ“¦ Time Capsule API

A RESTful API for creating and managing digital time capsulesâ€”messages securely stored and accessible only after a specified unlock date.

---

## ðŸš€ Features

* **Secure User Authentication**: Register/login with JWT-based tokens
* **Time Capsule Creation**: Store messages to be unlocked in the future
* **Access Control**: Capsules protected by secret unlock codes
* **Unlock Date Enforcement**: Capsules are only accessible after the unlock time
* **Expiration Policy**: Capsules expire 30 days post-unlock
* **Capsule Management**: Update or delete before unlock
* **Pagination Support**: Paginated capsule listing for efficient access
* **Automated Cleanup**: Background task for marking expired capsules

---

## ðŸ§° Tech Stack

* **Backend**: Node.js + Express
* **Database**: PostgreSQL + Sequelize ORM
* **Authentication**: JWT (JSON Web Tokens)
* **Testing**: Thunder + Postman
* **Scheduler**: node-cron for background tasks

---

## ðŸ”— API Endpoints

### ðŸ§‘ Authentication

* `POST /auth/register` â€” Register a new user
* `POST /auth/login` â€” Log in and receive a JWT token

### ðŸ“¦ Capsules

* `POST /capsules` â€” Create a time capsule
* `GET /capsules` â€” Get list of user's capsules (paginated)
* `GET /capsules/:id` â€” Get capsule (if unlockable with correct code)
* `PUT /capsules/:id` â€” Update a capsule (only before unlock, with valid code)
* `DELETE /capsules/:id` â€” Delete a capsule (only before unlock, with valid code)

---

## ðŸ—ï¸ Project Structure

```
time-capsule-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/        # App configuration files
â”‚   â”œâ”€â”€ controllers/   # Route handlers/controllers
â”‚   â”œâ”€â”€ middlewares/   # Middleware functions (auth, error handlers, etc.)
â”‚   â”œâ”€â”€ models/        # Sequelize models
â”‚   â”œâ”€â”€ routes/        # API route definitions
â”‚   â”œâ”€â”€ services/      # Business logic and service functions
â”‚   â”œâ”€â”€ utils/         # Helper utilities (hashing, date checks, etc.)
â”‚   â””â”€â”€ app.js         # Express app entry point
â”œâ”€â”€ tests/             # Unit and integration tests
â”œâ”€â”€ .env.example       # Sample environment config
â”œâ”€â”€ .gitignore         # Files ignored by Git
â”œâ”€â”€ package.json       # NPM dependencies and scripts
â””â”€â”€ README.md          # Project documentation
```

---

## ðŸ§ª Getting Started

### âœ… Prerequisites

* Node.js (v14+)
* PostgreSQL

### âš™ï¸ Installation

1. **Clone the repository**

```bash
git clone https://github.com/yourusername/time-capsule-api.git
cd time-capsule-api
```

2. **Install dependencies**

```bash
npm install
```

3. **Configure environment**

```bash
cp .env.example .env
# Edit the .env file to match your setup (DB credentials, secret keys, etc.)
```

4. **Run the server**

```bash
npm run dev
```

### ðŸ§ª Running Tests

```bash
npm test
```

---

## ðŸ”„ Capsule Lifecycle

1. **Created** â€” User submits a message and unlock date
2. **Pending Unlock** â€” Capsule is locked, editable/deletable with code
3. **Unlocked** â€” After unlock date, accessible with unlock code
4. **Expired** â€” 30 days post-unlock, capsule returns `410 Gone`

---

## ðŸ§  Design Decisions & Tradeoffs

### ðŸ” Security

* Unlock codes are hashed using bcrypt before storing
* JWT-based auth protects all user and capsule operations
* Access checks ensure capsules are only viewed/modified appropriately

### âš¡ Performance

* Capsule list paginated to avoid overloading responses
* Expired capsules are marked to reduce unnecessary checks
* Background task (via `node-cron`) handles expiry automation

### ðŸ§¹ Maintainability

* Clear separation of logic via MVC structure
* Test suite covers endpoints and logic thoroughly
* Standardized API with consistent HTTP status codes

### ðŸš€ Deployed link

https://time-capsule-47ba.onrender.com/ --- READY TO RUN ON POSTMAN OR THUNDER >>>
**Health Endpoint** [Check Health](https://time-capsule-47ba.onrender.com/health)
