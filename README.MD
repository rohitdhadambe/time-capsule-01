# ğŸ“¦ Time Capsule API

A RESTful API for creating and managing digital time capsulesâ€”messages securely stored and accessible only after a specified unlock date.

---

## ğŸš€ Deployment 
- **Base**: https://time-capsule-47ba.onrender.com/(CREATEDENDPOINTS) >>>> CAN BE CHECK ON POSTMAN OR ON THUNDER
- **Health Endpoint** [Check Health](https://time-capsule-47ba.onrender.com/health)

---

## ğŸš€ Features

* **Secure User Authentication**: Register/login with JWT-based tokens
* **Time Capsule Creation**: Store messages to be unlocked in the future
* **Access Control**: Capsules protected by secret unlock codes
* **Unlock Date Enforcement**: Capsules are only accessible after the unlock time
* **Expiration Policy**: Capsules expire 30 days post-unlock
* **Capsule Management**: Update or delete before unlock
* **Pagination Support**: Paginated capsule listing for efficient access
* **Automated Cleanup**: Background task for marking expired capsules

---

## ğŸ§° Tech Stack

* **Backend**: Node.js + Express
* **Database**: PostgreSQL
* **Authentication**: JWT (JSON Web Tokens)
* **Testing**: Thunder + Postman
* **Scheduler**: node-cron for background tasks

---

## ğŸ”— API Endpoints

### ğŸ§‘ Authentication

* `POST /auth/register` â€” Register a new user
* `POST /auth/login` â€” Log in and receive a JWT token

### ğŸ“¦ Capsules

* `POST /capsules` â€” Create a time capsule
* `GET /capsules` â€” Get list of user's capsules (paginated)
* `GET /capsules/:id` â€” Get capsule (if unlockable with correct code)
* `PUT /capsules/:id` â€” Update a capsule (only before unlock, with valid code)
* `DELETE /capsules/:id` â€” Delete a capsule (only before unlock, with valid code)

---

## ğŸ—ï¸ Project Structure

```
Backend/
â”œâ”€â”€ node_modules/     # Project dependencies
â”œâ”€â”€ src/              # Source files
â”‚ â”œâ”€â”€ config/         # Configuration files (e.g., DB, environment)
â”‚ â”œâ”€â”€ controllers/    # Controller logic for handling requests
â”‚ â”œâ”€â”€ middlewares/    # Middleware functions for request processing
â”‚ â”œâ”€â”€ models/         # Mongoose or Sequelize models
â”‚ â”œâ”€â”€ routes/         # Route definitions
â”‚ â”œâ”€â”€ services/       # Business logic/services
â”‚ â””â”€â”€ app.js          # App entry point
â”œâ”€â”€ test/             # Automated test cases
â”‚ â”œâ”€â”€ auth.test.js
â”‚ â””â”€â”€ capsule.test.js
â”œâ”€â”€ utils/            # Utility/helper functions
â”‚ â””â”€â”€ generateCode.js
â”œâ”€â”€ .env              # Environment-specific variables (not committed)
â”œâ”€â”€ .env.example      # Sample env file
â”œâ”€â”€ .gitignore        # Git ignore rules
â”œâ”€â”€ package.json      # Project metadata and scripts
â”œâ”€â”€ pnpm-lock.yaml    # Lock file for pnpm package manager
â”œâ”€â”€ req.json          # Sample API request/response schema
â”œâ”€â”€ API TESTING AND DATABASE INTEGRATION.pdf # Documentation
â””â”€â”€ README.md         # Project overview

---

## ğŸ§ª Getting Started

### âœ… Prerequisites

* Node.js (v14+)
* PostgreSQL

### âš™ï¸ Installation

1. **Clone the repository**

```bash
git clone https://github.com/yourusername/time-capsule-api.git
cd time-capsule-api
```

2. **Install dependencies**

```bash
pnpm install
```

3. **Configure environment**

```bash
cp .env.example .env
# Edit the .env file to match your setup (DB credentials, secret keys, etc.)
```

4. **Run the server**

```bash
pnpm run dev
```

### ğŸ§ª Running Tests

```bash
pnpm test
```

---

## ğŸ”„ Capsule Lifecycle

1. **Created** â€” User submits a message and unlock date
2. **Pending Unlock** â€” Capsule is locked, editable/deletable with code
3. **Unlocked** â€” After unlock date, accessible with unlock code
4. **Expired** â€” 30 days post-unlock, capsule returns `410 Gone`

---

## ğŸ§  Design Decisions & Tradeoffs

### ğŸ” Security

* Unlock codes are hashed using bcrypt before storing
* JWT-based auth protects all user and capsule operations
* Access checks ensure capsules are only viewed/modified appropriately

### âš¡ Performance

* Capsule list paginated to avoid overloading responses
* Expired capsules are marked to reduce unnecessary checks
* Background task (via `node-cron`) handles expiry automation

### ğŸ§¹ Maintainability

* Clear separation of logic via MVC structure
* Test suite covers endpoints and logic thoroughly
* Standardized API with consistent HTTP status codes


